{"remainingRequest":"C:\\xampp\\htdocs\\LAB11\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\LAB11\\src\\views\\Basket.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xampp\\htdocs\\LAB11\\src\\views\\Basket.vue","mtime":1670159742622},{"path":"C:\\xampp\\htdocs\\LAB11\\node_modules\\babel-loader\\lib\\index.js","mtime":1669898373313},{"path":"C:\\xampp\\htdocs\\LAB11\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1669898372387},{"path":"C:\\xampp\\htdocs\\LAB11\\node_modules\\vue-loader\\lib\\index.js","mtime":1669898365627}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRm9vdGVyIGZyb20gJ0AvY29tcG9uZW50cy9Gb290ZXIudnVlJw0KaW1wb3J0IEhlYWRlciBmcm9tICdAL2NvbXBvbmVudHMvSGVhZGVyLnZ1ZScNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgRm9vdGVyLA0KICAgIEhlYWRlcg0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB1c2VyOiB7DQogICAgICAgIGlkOiAnJywNCiAgICAgICAgbmFtZTogJycsDQogICAgICAgIGVtYWlsOiAnJywNCiAgICAgICAgc2Vzc2lvbl9pZDogJycNCiAgICAgIH0sDQogICAgICBwcm9kdWN0czogW10sDQogICAgICB0b3RhbFByaWNlOiAwLA0KICAgICAgdG90YWxRdWFudGl0eTogMA0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmdldFByb2R1Y3RzKCk7DQogICAgdGhpcy5nZXRUb3RhbFByaWNlKCk7DQogICAgdGhpcy5nZXRUb3RhbFF1YW50aXR5KCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBjbGVhckJhc2tldCgpIHsNCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnYmFza2V0L2NsZWFyQmFza2V0JykNCiAgICAgIHRoaXMuZ2V0UHJvZHVjdHMoKTsNCiAgICAgIHRoaXMuZ2V0VG90YWxQcmljZSgpOw0KICAgICAgdGhpcy5nZXRUb3RhbFF1YW50aXR5KCk7DQogICAgfSwNCiAgICBhc3luYyBwbGFjZU9yZGVyKCkgew0KICAgICAgbGV0IGRhdGEgPSAge3N0YXR1c19pZDogMSx1c2VybmFtZTogdGhpcy51c2VyLm5hbWUsIHRvdGFsUHJpY2U6IHRoaXMudG90YWxQcmljZSwgdG90YWxRdWFudGl0eTogdGhpcy50b3RhbFF1YW50aXR5LCBpdGVtczogdGhpcy5wcm9kdWN0c307DQogICAgICBpZiAoYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ29yZGVycy9hZGRPcmRlcicsIGRhdGEpKSB7DQogICAgICAgIHRoaXMuY2xlYXJCYXNrZXQoKQ0KICAgICAgICBhd2FpdCB0aGlzLiRyb3V0ZXIucHVzaCgnL21lc3NhZ2UvMycpDQogICAgICB9DQogICAgfSwNCiAgICBnZXRQcm9kdWN0cygpIHsNCiAgICAgIHRoaXMucHJvZHVjdHMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydiYXNrZXQvZ2V0UHJvZHVjdHMnXQ0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb2R1Y3RzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGxldCBwcm9kdWN0ID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sncHJvZHVjdHMvZ2V0UHJvZHVjdCddKHRoaXMucHJvZHVjdHNbaV0uaWQpDQogICAgICAgIHRoaXMucHJvZHVjdHNbaV0uaW1hZ2UgPSBwcm9kdWN0LmltYWdlOw0KICAgICAgICB0aGlzLnByb2R1Y3RzW2ldLm5hbWUgPSBwcm9kdWN0Lm5hbWU7DQogICAgICAgIHRoaXMucHJvZHVjdHNbaV0ucHJpY2UgPSBwcm9kdWN0LnByaWNlOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0VG90YWxQcmljZSgpIHsNCiAgICAgIHRoaXMudG90YWxQcmljZSA9IDA7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJvZHVjdHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdGhpcy50b3RhbFByaWNlICs9IHBhcnNlRmxvYXQodGhpcy5wcm9kdWN0c1tpXS5wcmljZSkgKiBwYXJzZUZsb2F0KHRoaXMucHJvZHVjdHNbaV0ucXVhbnRpdHkpOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0VG90YWxRdWFudGl0eSgpIHsNCiAgICAgIHRoaXMudG90YWxRdWFudGl0eSA9IDA7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJvZHVjdHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdGhpcy50b3RhbFF1YW50aXR5ICs9IHBhcnNlSW50KHRoaXMucHJvZHVjdHNbaV0ucXVhbnRpdHkpOw0KICAgICAgfQ0KICAgIH0sDQogICAgcmVtb3ZlKHByb2R1Y3RJZCkgew0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdiYXNrZXQvZGVjcmVtZW50UHJvZHVjdCcsIHByb2R1Y3RJZCkNCiAgICAgIHRoaXMudG90YWxQcmljZSAtPSBwYXJzZUZsb2F0KHRoaXMuJHN0b3JlLmdldHRlcnNbJ3Byb2R1Y3RzL2dldFByb2R1Y3QnXShwcm9kdWN0SWQpLnByaWNlKQ0KICAgICAgdGhpcy50b3RhbFF1YW50aXR5LS0NCiAgICB9LA0KICAgIGFkZChwcm9kdWN0SWQpIHsNCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnYmFza2V0L2luY3JlbWVudFByb2R1Y3QnLCBwcm9kdWN0SWQpDQogICAgICB0aGlzLnRvdGFsUHJpY2UgKz0gcGFyc2VGbG9hdCh0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcm9kdWN0cy9nZXRQcm9kdWN0J10ocHJvZHVjdElkKS5wcmljZSkNCiAgICAgIHRoaXMudG90YWxRdWFudGl0eSsrDQogICAgfSwNCiAgICBnZXRVc2VyKCkgew0KICAgICAgdGhpcy51c2VyID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndXNlci9nZXRVc2VyJ10NCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgdXNlckxvZ2dlZEluOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLmdldFVzZXIoKQ0KICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLnVzZXIpIHJldHVybiB0cnVlDQogICAgICByZXR1cm4gZmFsc2UNCiAgICB9DQogIH0sDQp9DQo="},{"version":3,"sources":["Basket.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Basket.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <Header/>\r\n    <br><br><br>\r\n    <div v-if=\"totalQuantity==0\" class=\"text-center\"><h1>Your Basket Is Empty</h1>\r\n      <router-link to=\"/products\">\r\n        <button class=\"btn\"> Keep Exploring</button>\r\n      </router-link>\r\n    </div>\r\n    <div v-else>\r\n      <div v-for=\"product in products\" :key=\"product.id\">\r\n        <div class=\"wrapper\">\r\n          <div class=\"container\">\r\n            <div class=\"row text-center\">\r\n              <img :src=\"'http://localhost/LAB11/public/images/' + product.image\" width=\"10%\" height=\"10%\" alt=\"\"/>\r\n              <h4><strong>{{ product.name }} x{{ product.quantity }} {{ product.price }}$</strong></h4>\r\n              <p style=\"text-align: center;\">\r\n                <button @click=\"remove(product.id)\" class=\"btn\">Remove one</button>\r\n                <button @click=\"add(product.id)\" class=\"btn \">Add Another</button>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"container\">\r\n        <div class=\"row text-center\">\r\n          <h4><strong>{{ totalQuantity }} Items Total Price:{{ totalPrice }}$</strong></h4>\r\n          <p style=\"text-align: center;\">\r\n            <router-link to=\"/products\">\r\n              <button class=\"btn\"> Keep Exploring</button>\r\n            </router-link>\r\n            <button @click=\"clearBasket()\" class=\"btn\">Empty Basket</button>\r\n            <button v-if=\"userLoggedIn\"  @click=\"placeOrder()\" class=\"btn \">Place Order</button>\r\n            <router-link v-else to=\"/login\">\r\n              <button class=\"btn\"> Login to place order</button>\r\n            </router-link>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <Footer/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Footer from '@/components/Footer.vue'\r\nimport Header from '@/components/Header.vue'\r\n\r\nexport default {\r\n  components: {\r\n    Footer,\r\n    Header\r\n  },\r\n  data() {\r\n    return {\r\n      user: {\r\n        id: '',\r\n        name: '',\r\n        email: '',\r\n        session_id: ''\r\n      },\r\n      products: [],\r\n      totalPrice: 0,\r\n      totalQuantity: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getProducts();\r\n    this.getTotalPrice();\r\n    this.getTotalQuantity();\r\n  },\r\n  methods: {\r\n    clearBasket() {\r\n      this.$store.commit('basket/clearBasket')\r\n      this.getProducts();\r\n      this.getTotalPrice();\r\n      this.getTotalQuantity();\r\n    },\r\n    async placeOrder() {\r\n      let data =  {status_id: 1,username: this.user.name, totalPrice: this.totalPrice, totalQuantity: this.totalQuantity, items: this.products};\r\n      if (await this.$store.dispatch('orders/addOrder', data)) {\r\n        this.clearBasket()\r\n        await this.$router.push('/message/3')\r\n      }\r\n    },\r\n    getProducts() {\r\n      this.products = this.$store.getters['basket/getProducts']\r\n      for (let i = 0; i < this.products.length; i++) {\r\n        let product = this.$store.getters['products/getProduct'](this.products[i].id)\r\n        this.products[i].image = product.image;\r\n        this.products[i].name = product.name;\r\n        this.products[i].price = product.price;\r\n      }\r\n    },\r\n    getTotalPrice() {\r\n      this.totalPrice = 0;\r\n      for (let i = 0; i < this.products.length; i++) {\r\n        this.totalPrice += parseFloat(this.products[i].price) * parseFloat(this.products[i].quantity);\r\n      }\r\n    },\r\n    getTotalQuantity() {\r\n      this.totalQuantity = 0;\r\n      for (let i = 0; i < this.products.length; i++) {\r\n        this.totalQuantity += parseInt(this.products[i].quantity);\r\n      }\r\n    },\r\n    remove(productId) {\r\n      this.$store.commit('basket/decrementProduct', productId)\r\n      this.totalPrice -= parseFloat(this.$store.getters['products/getProduct'](productId).price)\r\n      this.totalQuantity--\r\n    },\r\n    add(productId) {\r\n      this.$store.commit('basket/incrementProduct', productId)\r\n      this.totalPrice += parseFloat(this.$store.getters['products/getProduct'](productId).price)\r\n      this.totalQuantity++\r\n    },\r\n    getUser() {\r\n      this.user = this.$store.getters['user/getUser']\r\n    }\r\n  },\r\n  computed: {\r\n    userLoggedIn: function () {\r\n      this.getUser()\r\n      for (let i in this.user) return true\r\n      return false\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>"]}]}